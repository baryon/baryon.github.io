<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>例子 - Payment Processing 付款程序 | 重粒子空间</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Code&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300;400;500;700&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;700&amp;display=swap">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script data-ad-client="ca-pub-2028497727822047" async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link rel="alternate" type="application/rss+xml" href="https://lilong.net/rss.xml" title="重粒子空间 RSS Feed">
    <meta name="description" content="::: info

翻译自Payment Processing &#8212; Bitcoin
内容在整理，准确性请自己确认

:::

Payment Processing 付款程序[](https://developer. ...">
    <meta property="article:published_time" content="2020-11-03T04:00:00.000Z">
    <meta property="article:modified_time" content="2020-11-11T02:30:57.000Z">
    <meta property="og:site_name" content="重粒子空间">
    <meta property="og:title" content="例子 - Payment Processing 付款程序">
    <meta property="og:description" content="::: info

翻译自Payment Processing &#8212; Bitcoin
内容在整理，准确性请自己确认

:::

Payment Processing 付款程序[](https://developer. ...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/2020/11/03/_04-payment-processing/">
    <meta name="twitter:title" content="例子 - Payment Processing 付款程序">
    <meta name="twitter:description" content="::: info

翻译自Payment Processing &#8212; Bitcoin
内容在整理，准确性请自己确认

:::

Payment Processing 付款程序[](https://developer. ...">
    <meta name="twitter:url" content="/2020/11/03/_04-payment-processing/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="比特币, 翻译, 比特币开发指南">
    <meta property="article:tag" content="比特币">
    <meta name="keywords" content="李龙,李龍,baryon,bitcoin,比特币,BSV">
    <meta name="author" content="LI Long">
    
    <link rel="preload" href="/assets/css/0.styles.a7e336af.css" as="style"><link rel="preload" href="/assets/js/app.abf5d3ec.js" as="script"><link rel="preload" href="/assets/js/8.ce1c8cc9.js" as="script"><link rel="preload" href="/assets/js/3.414e57ad.js" as="script"><link rel="preload" href="/assets/js/37.0fd00712.js" as="script"><link rel="prefetch" href="/assets/js/10.3c652f80.js"><link rel="prefetch" href="/assets/js/11.3031be9d.js"><link rel="prefetch" href="/assets/js/12.f36c79bc.js"><link rel="prefetch" href="/assets/js/13.f2b3627c.js"><link rel="prefetch" href="/assets/js/14.30835e3c.js"><link rel="prefetch" href="/assets/js/15.30714548.js"><link rel="prefetch" href="/assets/js/16.d18f6acc.js"><link rel="prefetch" href="/assets/js/17.37713c96.js"><link rel="prefetch" href="/assets/js/18.0456b1fb.js"><link rel="prefetch" href="/assets/js/19.df061aac.js"><link rel="prefetch" href="/assets/js/20.b671335a.js"><link rel="prefetch" href="/assets/js/21.d39d13fd.js"><link rel="prefetch" href="/assets/js/22.22289641.js"><link rel="prefetch" href="/assets/js/23.9682cf79.js"><link rel="prefetch" href="/assets/js/24.b56b4a09.js"><link rel="prefetch" href="/assets/js/25.e10fe55e.js"><link rel="prefetch" href="/assets/js/26.7960b5af.js"><link rel="prefetch" href="/assets/js/27.c18b8ae0.js"><link rel="prefetch" href="/assets/js/28.13d07b15.js"><link rel="prefetch" href="/assets/js/29.e7e365f1.js"><link rel="prefetch" href="/assets/js/30.e2b7212a.js"><link rel="prefetch" href="/assets/js/31.0a61aa61.js"><link rel="prefetch" href="/assets/js/32.399fd60a.js"><link rel="prefetch" href="/assets/js/33.102e2538.js"><link rel="prefetch" href="/assets/js/34.a2a0eb8a.js"><link rel="prefetch" href="/assets/js/35.fd54c5ac.js"><link rel="prefetch" href="/assets/js/36.7824120d.js"><link rel="prefetch" href="/assets/js/38.5a9b40ff.js"><link rel="prefetch" href="/assets/js/39.64725c25.js"><link rel="prefetch" href="/assets/js/4.5d973e8f.js"><link rel="prefetch" href="/assets/js/40.086e3669.js"><link rel="prefetch" href="/assets/js/41.fb9be79b.js"><link rel="prefetch" href="/assets/js/42.2ad9a948.js"><link rel="prefetch" href="/assets/js/43.99993d3a.js"><link rel="prefetch" href="/assets/js/44.42442c0d.js"><link rel="prefetch" href="/assets/js/45.b0dc0368.js"><link rel="prefetch" href="/assets/js/46.3e03bbf4.js"><link rel="prefetch" href="/assets/js/47.cef55138.js"><link rel="prefetch" href="/assets/js/48.bfadcecc.js"><link rel="prefetch" href="/assets/js/49.da0ca54b.js"><link rel="prefetch" href="/assets/js/5.a325b366.js"><link rel="prefetch" href="/assets/js/50.e2220d6e.js"><link rel="prefetch" href="/assets/js/51.39a541e6.js"><link rel="prefetch" href="/assets/js/52.b0cc67f4.js"><link rel="prefetch" href="/assets/js/53.0ad26773.js"><link rel="prefetch" href="/assets/js/54.4c3c30c6.js"><link rel="prefetch" href="/assets/js/55.6f14161b.js"><link rel="prefetch" href="/assets/js/56.ece3c07b.js"><link rel="prefetch" href="/assets/js/57.9efa525e.js"><link rel="prefetch" href="/assets/js/58.0b439759.js"><link rel="prefetch" href="/assets/js/59.8dc823c7.js"><link rel="prefetch" href="/assets/js/6.307deff6.js"><link rel="prefetch" href="/assets/js/60.15e33e41.js"><link rel="prefetch" href="/assets/js/61.b136f576.js"><link rel="prefetch" href="/assets/js/62.f4d9c125.js"><link rel="prefetch" href="/assets/js/7.75ec5eb7.js"><link rel="prefetch" href="/assets/js/9.3cace592.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.851a26a5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a7e336af.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">重粒子空间 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/about/" class="nav-link">关于</a></li><li class="nav-item"><a href="/tag/" class="nav-link">标签</a></li><li class="nav-item"><a href="/tag/比特币开发指南/" class="nav-link">比特币开发指南</a></li><li class="nav-item"><a href="/tag/sCrypt/" class="nav-link">打开sCrypt的盒子</a></li><li class="nav-item"><a href="https://lilong.net/MasterBitcoinSV/" target="_blank" rel="noopener noreferrer" class="nav-link external">精通比特币SV</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">重粒子空间 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/about/" class="nav-link">关于</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">标签</a></li><li class="mobile-nav-item"><a href="/tag/比特币开发指南/" class="nav-link">比特币开发指南</a></li><li class="mobile-nav-item"><a href="/tag/sCrypt/" class="nav-link">打开sCrypt的盒子</a></li><li class="mobile-nav-item"><a href="https://lilong.net/MasterBitcoinSV/" target="_blank" rel="noopener noreferrer" class="nav-link external">精通比特币SV</a></li> <li class="mobile-nav-item"><a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        例子 - Payment Processing 付款程序
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020-11-03 04:00">
      2020-11-03 4:00 AM
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/比特币" data-v-42ccfcd5><span data-v-42ccfcd5>比特币</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/翻译" data-v-42ccfcd5><span data-v-42ccfcd5>翻译</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/比特币开发指南" data-v-42ccfcd5><span data-v-42ccfcd5>比特币开发指南</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>::: info</p> <p>翻译自<a href="https://developer.bitcoin.org/examples/payment_processing.html#payment-processing" target="_blank" rel="noopener noreferrer">Payment Processing — Bitcoin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
内容在整理，准确性请自己确认</p> <p>:::</p> <h1 id="payment-processing-付款程序"><a href="#payment-processing-付款程序" class="header-anchor">#</a> Payment Processing 付款程序<a href="https://developer.bitcoin.org/examples/payment_processing.html#payment-processing" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h1> <h2 id="payment-protocol-付款程序"><a href="#payment-protocol-付款程序" class="header-anchor">#</a> Payment Protocol 付款程序<a href="https://developer.bitcoin.org/examples/payment_processing.html#payment-protocol" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>To request payment using the payment protocol, you use an extended (but backwards-compatible) <a href="https://developer.bitcoin.org/terms.html#term-bitcoin-uri" target="_blank" rel="noopener noreferrer">“bitcoin:” URI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. For example:</p> <p>要使用支付协议请求支付，您可以使用扩展(但向后兼容)的“ bitcoin: ” URI:</p> <p><img alt="Warning icon" data-src="https://developer.bitcoin.org/_images/icon_warning.svg" loading="lazy" class="lazy"> <strong>Warning:</strong> The payment protocol is considered to be deprecated and will be removed in a later version of Bitcoin Core. The protocol has multiple security design flaws and implementation flaws in some wallets. Users will begin receiving deprecation warnings in Bitcoin Core version 0.18 when using <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> URI’s. Merchants should transition away from <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to more secure options such as <a href="https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki" target="_blank" rel="noopener noreferrer">BIP21<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Merchants should never require <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> payments and should provide <a href="https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki" target="_blank" rel="noopener noreferrer">BIP21<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> fallbacks.</p> <p>警告: 支付协议被认为是不推荐的，并将被删除在后来版本的比特币核心。该协议存在多种安全设计缺陷，部分钱包存在实现缺陷。当使用 BIP70 URI 时，用户将开始收到比特币核心0.18版本的弃用警告。商家应该从 BIP70过渡到更安全的选择，比如 BIP21。商家永远不应该要求 BIP70支付，应该提供 BIP21备用。</p> <p>bitcoin:mjSk1Ny9spzU2fouzYgLqGUD8U41iR35QN<br>
?amount=0.10<br>
&amp;label=Example+Merchant<br>
&amp;message=Order+of+flowers+%26+chocolates<br>
&amp;r=https://example.com/pay.php/invoice%3Dda39a3ee</p> <p>The browser, QR code reader, or other program processing the URI opens the spender’s Bitcoin wallet program on the URI. If the wallet program is aware of the payment protocol, it accesses the URL specified in the <a href="https://developer.bitcoin.org/terms.html#term-r-parameter" target="_blank" rel="noopener noreferrer">“r”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>parameter, which should provide it with a serialized <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> served with the <a href="https://en.wikipedia.org/wiki/Internet_media_type" target="_blank" rel="noopener noreferrer">MIME<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> type <code>application/bitcoin-paymentrequest</code>.</p> <p>浏览器、二维码阅读器或其他处理 URI 的程序会在 URI 上打开挥金如土的比特币钱包程序。如果钱包程序知道支付协议，它会访问“ r”参数中指定的 URL，这将为它提供与 MIME 类型应用程序/比特币支付请求一起服务的序列化 PaymentRequest。</p> <p><strong>Resource:</strong> Gavin Andresen’s <a href="https://github.com/gavinandresen/paymentrequest/blob/master/php/demo_website/createpaymentrequest.php" target="_blank" rel="noopener noreferrer">Payment Request Generator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> generates custom example URIs and payment requests for use with testnet.</p> <p>资源: Gavin Andresen 的支付请求生成器生成用于 testnet 的定制样例 uri 和支付请求。</p> <h3 id="paymentrequest-paymentdetails-支付请求和支付详细信息"><a href="#paymentrequest-paymentdetails-支付请求和支付详细信息" class="header-anchor">#</a> PaymentRequest &amp; PaymentDetails 支付请求和支付详细信息<a href="https://developer.bitcoin.org/examples/payment_processing.html#paymentrequest-paymentdetails" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>The <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is created with data structures built using Google’s <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">Protocol Buffers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> describes these data structures in the non-sequential way they’re defined in the payment request <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">protocol buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> code, but the text below will describe them in a more linear order using a simple (but functional) Python CGI program. (For brevity and clarity, many normal CGI best practices are not used in this program.)</p> <p>支付请求是使用谷歌的协议缓冲数据结构创建的。BIP70以非顺序的方式描述了这些数据结构，它们是在支付请求协议缓冲代码中定义的，但是下面的文本将使用一个简单的(但是功能性的) Python CGI 程序以更加线性的顺序描述它们。(为了简洁和清晰，许多常规的 CGI 最佳实践在本程序中没有使用。)</p> <p>The full sequence of events is illustrated below, starting with the spender clicking a <a href="https://developer.bitcoin.org/terms.html#term-bitcoin-uri" target="_blank" rel="noopener noreferrer">“bitcoin:” URI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or scanning a <code>bitcoin:</code> QR code.</p> <p>完整的事件序列如下图所示，从挥金如土的人点击“比特币: ” URI 或扫描比特币: QR 码开始。</p> <p><img alt="BIP70 Payment Protocol" data-src="https://developer.bitcoin.org/_images/en-payment-protocol.svg" loading="lazy" class="lazy"></p> <p>BIP70 Payment Protocol<a href="https://developer.bitcoin.org/examples/payment_processing.html#id1" title="Permalink to this image" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>支付协议</p> <p>For the script to use the <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">protocol buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, you will need a copy of Google’s <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">Protocol Buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> compiler (<code>protoc</code>), which is available in most modern Linux package managers and <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">directly from Google.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Non-Google <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">protocol buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> compilers are available for a variety of programming languages. You will also need a copy of the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/bitcoin/bitcoin/blob/0.19/src/qt/paymentrequest.proto" target="_blank" rel="noopener noreferrer">Protocol Buffer description<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from the Bitcoin Core source code.</p> <p>对于使用协议缓冲区的脚本，您将需要一个 Google 的 Protocol Buffer 编译器(protoc)的副本，这个副本可以在大多数现代 Linux 包管理器中使用，也可以直接从 Google 获得。非谷歌协议缓冲编译器可用于各种编程语言。您还需要一个来自比特币核心源代码的 PaymentRequest 协议缓冲描述的副本。</p> <h4 id="initialization-code-初始化代码"><a href="#initialization-code-初始化代码" class="header-anchor">#</a> Initialization Code 初始化代码<a href="https://developer.bitcoin.org/examples/payment_processing.html#initialization-code" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>With the Python code generated by <code>protoc</code>, we can start our simple CGI program.</p> <p>使用 protoc 生成的 Python 代码，我们可以启动简单的 CGI 程序。</p> <p>#!/usr/bin/env python</p> <h2 id="this-is-the-code-generated-by-protoc-python-out-paymentrequest-paymentrequest-proto"><a href="#this-is-the-code-generated-by-protoc-python-out-paymentrequest-paymentrequest-proto" class="header-anchor">#</a> This is the code generated by protoc --python_out=./ [paymentrequest][paymentrequest].proto</h2> <p>from paymentrequest_pb2 import *</p> <h2 id="load-some-functions"><a href="#load-some-functions" class="header-anchor">#</a> Load some functions</h2> <p>from time import time
from sys import stdout
from OpenSSL.crypto import FILETYPE_PEM, load_privatekey, sign</p> <h2 id="copy-three-of-the-classes-created-by-protoc-into-objects-we-can-use"><a href="#copy-three-of-the-classes-created-by-protoc-into-objects-we-can-use" class="header-anchor">#</a> Copy three of the classes created by protoc into objects we can use</h2> <p>details = [PaymentDetails]<a href="">paymentdetails</a>
request = [PaymentRequest]<a href="">paymentrequest</a>
x509 = [X509Certificates]<a href="">x509certificates</a></p> <p>The startup code above is quite simple, requiring nothing but the epoch (Unix date) time function, the standard out file descriptor, a few functions from the OpenSSL library, and the data structures and functions created by <code>protoc</code>.</p> <p>上面的启动代码非常简单，只需要 epoch (Unix date) time 函数、标准输出文件描述符、 OpenSSL 库中的一些函数以及由 protoc 创建的数据结构和函数。</p> <h4 id="configuration-code-配置代码"><a href="#configuration-code-配置代码" class="header-anchor">#</a> Configuration Code 配置代码<a href="https://developer.bitcoin.org/examples/payment_processing.html#configuration-code" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Next, we’ll set configuration settings which will typically only change when the receiver wants to do something differently. The code pushes a few settings into the <code>request</code> (<a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) and <code>details</code> (<a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) objects. When we serialize them, <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> will be contained within the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>接下来，我们将设置配置设置，这通常只有当接收者想要做一些不同的事情时才会改变。代码将一些设置推送到请求(PaymentRequest)和详细信息(PaymentDetails)对象中。序列化它们时，PaymentDetails 将包含在 PaymentRequest 中。</p> <h2 id="ssl-signature-method"><a href="#ssl-signature-method" class="header-anchor">#</a> SSL Signature method</h2> <p>request.pki_type = &quot;x509+sha256&quot;  ## Default: none</p> <h2 id="mainnet-or-testnet"><a href="#mainnet-or-testnet" class="header-anchor">#</a> Mainnet or testnet?</h2> <p>details.[network][network] = &quot;test&quot;  ## Default: main</p> <h2 id="postback-url"><a href="#postback-url" class="header-anchor">#</a> Postback URL</h2> <p>details.payment_url = &quot;https://example.com/pay.py&quot;</p> <h2 id="paymentdetails-paymentdetails-version-number"><a href="#paymentdetails-paymentdetails-version-number" class="header-anchor">#</a> [PaymentDetails][paymentdetails] version number</h2> <p>request.payment_details_version = 1  ## Default: 1</p> <h2 id="certificate-chain-certificate-chain"><a href="#certificate-chain-certificate-chain" class="header-anchor">#</a> [Certificate chain][certificate chain]</h2> <p>x509.certificate.append(file(&quot;/etc/apache2/example.com-cert.[der][der]&quot;, &quot;r&quot;).read())
#x509.certificate.append(file(&quot;/some/intermediate/cert.[der][der]&quot;, &quot;r&quot;).read())</p> <h2 id="load-private-ssl-key-into-memory-for-signing-later"><a href="#load-private-ssl-key-into-memory-for-signing-later" class="header-anchor">#</a> Load private SSL key into memory for signing later</h2> <p>priv_key = &quot;/etc/apache2/example.com-key.pem&quot;
pw = &quot;test&quot;  ## Key password
private_key = load_privatekey(FILETYPE_PEM, file(priv_key, &quot;r&quot;).read(), pw)</p> <p>Each line is described below.</p> <p>每一行都在下面描述。</p> <p>request.pki_type = &quot;x509+sha256&quot;  ## Default: none</p> <p><a href="https://developer.bitcoin.org/terms.html#term-pp-pki-type" target="_blank" rel="noopener noreferrer">“pki_type”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: (optional) tell the receiving wallet program what <a href="https://developer.bitcoin.org/terms.html#term-pki" target="_blank" rel="noopener noreferrer">Public-Key Infrastructure<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (<a href="https://developer.bitcoin.org/terms.html#term-pki" target="_blank" rel="noopener noreferrer">PKI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) type you’re using to cryptographically sign your <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> so that it can’t be modified by a <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" target="_blank" rel="noopener noreferrer">man-in-the-middle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> attack.</p> <p>“ PKI _ type” : (可选)告诉接收钱包程序你正在使用什么公开金钥基础建设(PKI)类型来对你的付款请求进行加密签名，这样它就不会被中间人攻击修改。</p> <p>If you don’t want to sign the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, you can choose a <a href="https://developer.bitcoin.org/terms.html#term-pp-pki-type" target="_blank" rel="noopener noreferrer">“pki_type”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of <code>none</code> (the default).</p> <p>如果您不想签署 PaymentRequest，可以选择“ pki _ type”为 none (默认值)。</p> <p>If you do choose the sign the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, you currently have two options defined by <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>x509+sha1</code>and <code>x509+sha256</code>. Both options use the <a href="https://en.wikipedia.org/wiki/X.509" target="_blank" rel="noopener noreferrer">X.509<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> certificate system, the same system used for HTTP Secure (HTTPS). To use either option, you will need a certificate signed by a certificate authority or one of their intermediaries. (A self-signed certificate will not work.)</p> <p>如果您确实选择了签名 PaymentRequest，那么您目前有两个由 BIP70定义的选项: x509 + sha1和 x509 + sha256。这两个选项都使用 x. 509证书系统，该系统与 HTTP 安全(HTTPS)使用的系统相同。要使用这两个选项中的任何一个，您都需要由证书颁发机构或其中介机构签署的证书。(自签名证书不起作用。)</p> <p>Each wallet program may choose which certificate authorities to trust, but it’s likely that they’ll trust whatever certificate authorities their operating system trusts. If the wallet program doesn’t have a full operating system, as might be the case for small hardware wallets, <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> suggests they use the <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/" target="_blank" rel="noopener noreferrer">Mozilla Root Certificate Store<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. In general, if a certificate works in your web browser when you connect to your webserver, it will work for your <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>每个钱包程序可以选择要信任的证书颁发机构，但是它们很可能会信任任何操作系统信任的证书颁发机构。如果钱包程序没有一个完整的操作系统，就像小型硬件钱包一样，BIP70建议他们使用 Mozilla 根证书商店。一般来说，如果连接到 web 服务器时证书在您的 web 浏览器中工作，那么它将适用于您的 PaymentRequests。</p> <p>details.[network][network] = &quot;test&quot;  ## Default: main</p> <p><code>network</code>: (optional) tell the spender’s wallet program what Bitcoin <a href="https://developer.bitcoin.org/devguide/p2p_network.html" target="_blank" rel="noopener noreferrer">network<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> you’re using; <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> defines “main” for mainnet (actual payments) and “test” for testnet (like mainnet, but fake satoshis are used). If the wallet program doesn’t run on the <a href="https://developer.bitcoin.org/devguide/p2p_network.html" target="_blank" rel="noopener noreferrer">network<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> you indicate, it will reject the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Network: (可选)告诉消费者的钱包程序你使用的是哪个比特币网络; BIP70为 mainnet 定义了“ main”(实际支付) ，为 testnet 定义了“ test”(比如 mainnet，但使用的是假的 satoshis)。如果钱包程序没有在您指示的网络上运行，它将拒绝 PaymentRequest。</p> <p>details.payment_url = &quot;https://example.com/pay.py&quot;</p> <p><code>payment_url</code>: (required) tell the spender’s wallet program where to send the Payment message (described later). This can be a static URL, as in this example, or a variable URL such as <code>https://example.com/pay.py?invoice=123.</code> It should usually be an HTTPS address to prevent <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" target="_blank" rel="noopener noreferrer">man-in-the-middle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> attacks from modifying the message.</p> <p>Payment _ url: (必需的)告诉消费者的钱包程序在哪里发送付款消息(后面将描述)。这可以是一个静态 URL，如本例中所示，也可以是一个变量 URL，如 https://example.com/pay.py?invoice=123。它通常应该是一个 HTTPS 地址，以防止中间人攻击修改消息。</p> <p>request.payment_details_version = 1  ## Default: 1</p> <p><code>payment_details_version</code>: (optional) tell the spender’s wallet program what version of the <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>you’re using. As of this writing, the only version is version 1.</p> <p>支付详情版本: (可选)告诉消费者的钱包程序你使用的是哪个版本的支付详情。在写这篇文章时，唯一的版本是版本1。</p> <h2 id="this-is-the-pubkey-certificate-corresponding-to-the-private-ssl-key"><a href="#this-is-the-pubkey-certificate-corresponding-to-the-private-ssl-key" class="header-anchor">#</a> This is the pubkey/certificate corresponding to the private SSL key</h2> <h2 id="that-we-ll-use-to-sign"><a href="#that-we-ll-use-to-sign" class="header-anchor">#</a> that we'll use to sign:</h2> <p>x509.certificate.append(file(&quot;/etc/apache2/example.com-cert.[der][der]&quot;, &quot;r&quot;).read())</p> <p><code>x509certificates</code>: (required for signed <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) you must provide the public SSL key/certificate corresponding to the private SSL key you’ll use to sign the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The certificate must be in ASN.1/<a href="https://en.wikipedia.org/wiki/X.690#DER_encoding" target="_blank" rel="noopener noreferrer">DER format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>X509certificates: (签名的 PaymentRequests 需要)您必须提供与用于签名 PaymentRequest 的私有 SSL 密钥相对应的公共 SSL 密钥/证书。证书必须是 ASN. 1/DER 格式。</p> <h2 id="if-the-pubkey-cert-above-didn-t-have-the-signature-of-a-root"><a href="#if-the-pubkey-cert-above-didn-t-have-the-signature-of-a-root" class="header-anchor">#</a> If the pubkey/cert above didn't have the signature of a root</h2> <h2 id="certificate-authority-we-d-then-append-the-intermediate-certificate-intermediate-certificate"><a href="#certificate-authority-we-d-then-append-the-intermediate-certificate-intermediate-certificate" class="header-anchor">#</a> certificate authority, we'd then append the [intermediate certificate][intermediate certificate]</h2> <h2 id="which-signed-it"><a href="#which-signed-it" class="header-anchor">#</a> which signed it:</h2> <p>#x509.certificate.append(file(&quot;/some/intermediate/cert.[der][der]&quot;, &quot;r&quot;).read())</p> <p>You must also provide any <a href="https://developer.bitcoin.org/terms.html#term-intermediate-certificate" target="_blank" rel="noopener noreferrer">intermediate certificates<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> necessary to link your certificate to the <a href="https://developer.bitcoin.org/terms.html#term-root-certificate" target="_blank" rel="noopener noreferrer">root certificate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of a certificate authority trusted by the spender’s software, such as a certificate from the Mozilla root store.</p> <p>您还必须提供任何必要的中间证书，以便将证书链接到消费者软件信任的证书颁发机构的证书根证书，例如来自 Mozilla 根存储的证书。</p> <p>The certificates must be provided in a specific order—the same order used by Apache’s <code>SSLCertificateFile</code>directive and other server software. The figure below shows the <a href="https://developer.bitcoin.org/terms.html#term-certificate-chain" target="_blank" rel="noopener noreferrer">certificate chain<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of the www.bitcoin.org <a href="https://en.wikipedia.org/wiki/X.509" target="_blank" rel="noopener noreferrer">X.509<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>certificate and how each certificate (except the <a href="https://developer.bitcoin.org/terms.html#term-root-certificate" target="_blank" rel="noopener noreferrer">root certificate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) would be loaded into the <a href="https://developer.bitcoin.org/terms.html#term-x509certificates" target="_blank" rel="noopener noreferrer">X509Certificates<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">protocol buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> message.</p> <p>证书必须以特定的顺序提供ーー与 Apache 的 SSLCertificateFile 指令和其他服务器软件使用的顺序相同。下图显示了 www.bitcoin.org x. 509证书的证书链，以及如何将每个证书(根证书证书除外)加载到 X509Certificates protocol buffer 消息中。</p> <p><img alt="X509Certificates Loading Order" data-src="https://developer.bitcoin.org/_images/en-cert-order.svg" loading="lazy" class="lazy"></p> <p>X509Certificates Loading Order<a href="https://developer.bitcoin.org/examples/payment_processing.html#id2" title="Permalink to this image" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>To be specific, the first certificate provided must be the <a href="https://en.wikipedia.org/wiki/X.509" target="_blank" rel="noopener noreferrer">X.509<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> certificate corresponding to the private SSL key which will make the signature, called the <a href="https://developer.bitcoin.org/terms.html#term-leaf-certificate" target="_blank" rel="noopener noreferrer">leaf certificate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Any <a href="https://developer.bitcoin.org/terms.html#term-intermediate-certificate" target="_blank" rel="noopener noreferrer">intermediate certificates<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> necessary to link that signed public SSL key to the <a href="https://developer.bitcoin.org/terms.html#term-root-certificate" target="_blank" rel="noopener noreferrer">root certificate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (the certificate authority) are attached separately, with each certificate in <a href="https://en.wikipedia.org/wiki/X.690#DER_encoding" target="_blank" rel="noopener noreferrer">DER format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> bearing the signature of the certificate that follows it all the way to (but not including) the <a href="https://developer.bitcoin.org/terms.html#term-root-certificate" target="_blank" rel="noopener noreferrer">root certificate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>具体地说，所提供的第一个证书必须是与私有 SSL 密钥相对应的 x. 509证书，该私有 SSL 密钥将生成签名(称为叶证书)。任何必要的中间证书，将签署的公共 SSL 密钥链接到证书中心(认证机构)都是单独附加的，每个 DER 格式的证书都带有证书的签名，一直到(但不包括)根证书中心。</p> <p>priv_key = &quot;/etc/apache2/example.com-key.pem&quot;
pw = &quot;test&quot;  ## Key password
private_key = load_privatekey(FILETYPE_PEM, file(priv_key, &quot;r&quot;).read(), pw)</p> <p>(Required for signed <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) you will need a private SSL key in a format your SSL library supports (<a href="https://en.wikipedia.org/wiki/X.690#DER_encoding" target="_blank" rel="noopener noreferrer">DER format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is not required). In this program, we’ll load it from a PEM file. (Embedding your passphrase in your CGI code, as done here, is obviously a bad idea in real life.)</p> <p>(需要签名的付款请求)您将需要一个您的 SSL 库支持的格式的私有 SSL 密钥(不需要 DER 格式)。在这个程序中，我们将从 PEM 文件加载它。(在 CGI 代码中嵌入密码，就像这里做的一样，在现实生活中显然是个坏主意。)</p> <p>The private SSL key will not be transmitted with your request. We’re only loading it into memory here so we can use it to sign the request later.</p> <p>私有 SSL 密钥不会随您的请求一起传输。我们只是将它加载到这里的内存中，这样以后我们就可以使用它来签署请求。</p> <h4 id="code-variables-代码变量"><a href="#code-variables-代码变量" class="header-anchor">#</a> Code Variables 代码变量<a href="https://developer.bitcoin.org/examples/payment_processing.html#code-variables" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Now let’s look at the variables your CGI program will likely set for each payment.</p> <p>现在让我们来看看您的 CGI 程序可能为每次付款设置的变量。</p> <h2 id="amount-of-the-request"><a href="#amount-of-the-request" class="header-anchor">#</a> Amount of the request</h2> <p>amount = 10000000  ## In satoshis</p> <h2 id="p2pkh-pubkey-hash"><a href="#p2pkh-pubkey-hash" class="header-anchor">#</a> P2PKH pubkey hash</h2> <p>pubkey_hash = &quot;2b14950b8d31620c6cc923c5408a701b1ec0a020&quot;</p> <h2 id="p2pkh-pubkey-script-entered-as-hex-and-converted-to-binary"><a href="#p2pkh-pubkey-script-entered-as-hex-and-converted-to-binary" class="header-anchor">#</a> P2PKH pubkey script entered as hex and converted to binary</h2> <h1 id="op-dup-op-hash160-push-20-bytes-op-equalverify-op-checksig"><a href="#op-dup-op-hash160-push-20-bytes-op-equalverify-op-checksig" class="header-anchor">#</a> OP_DUP OP_HASH160 &lt;push 20 bytes&gt; <pubKey hash=""> OP_EQUALVERIFY OP_CHECKSIG</pubKey></h1> <h1 id="_76-a9-14-88-ac"><a href="#_76-a9-14-88-ac" class="header-anchor">#</a> 76       a9            14       <pubKey hash="">        88          ac</pubKey></h1> <p>hex_script = &quot;76&quot; + &quot;a9&quot; + &quot;14&quot; + pubkey_hash + &quot;88&quot; + &quot;ac&quot;
serialized_script = hex_script.decode(&quot;hex&quot;)</p> <h2 id="load-amount-and-pubkey-script-into-paymentdetails-paymentdetails"><a href="#load-amount-and-pubkey-script-into-paymentdetails-paymentdetails" class="header-anchor">#</a> Load amount and pubkey script into [PaymentDetails][paymentdetails]</h2> <p>details.outputs.add(amount = amount, script = serialized_script)</p> <h2 id="memo-to-display-to-the-spender"><a href="#memo-to-display-to-the-spender" class="header-anchor">#</a> Memo to display to the spender</h2> <p>details.memo = &quot;Flowers &amp; chocolates&quot;</p> <h2 id="data-which-should-be-returned-to-you-with-the-payment"><a href="#data-which-should-be-returned-to-you-with-the-payment" class="header-anchor">#</a> Data which should be returned to you with the payment</h2> <p>details.merchant_data = &quot;Invoice #123&quot;</p> <p>Each line is described below.</p> <p>每一行都在下面描述。</p> <p>amount = 10000000  ## In satoshis (=100 mBTC)</p> <p><a href="https://developer.bitcoin.org/terms.html#term-pp-amount" target="_blank" rel="noopener noreferrer">“amount”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: (optional) the <a href="https://developer.bitcoin.org/terms.html#term-pp-amount" target="_blank" rel="noopener noreferrer">amount<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> you want the spender to pay. You’ll probably get this value from your shopping cart application or <a href="https://developer.bitcoin.org/terms.html#term-fiat" target="_blank" rel="noopener noreferrer">fiat<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>-to-BTC exchange rate conversion tool. If you leave the amount blank, the wallet program will prompt the spender how much to pay (which can be useful for donations).</p> <p>“金额” : (可选)你希望消费者支付的金额。您可能会从您的购物车应用程序或菲亚特到 btc 的汇率转换工具得到这个值。如果你留下空白数额，钱包程序将提示消费者支付多少(这可能是有用的捐款)。</p> <p>pubkey_hash = &quot;2b14950b8d31620c6cc923c5408a701b1ec0a020&quot;</p> <h1 id="op-dup-op-hash160-push-20-bytes-op-equalverify-op-checksig-2"><a href="#op-dup-op-hash160-push-20-bytes-op-equalverify-op-checksig-2" class="header-anchor">#</a> OP_DUP OP_HASH160 &lt;push 20 bytes&gt; <pubKey hash=""> OP_EQUALVERIFY OP_CHECKSIG</pubKey></h1> <h1 id="_76-a9-14-88-ac-2"><a href="#_76-a9-14-88-ac-2" class="header-anchor">#</a> 76       a9            14       <pubKey hash="">        88          ac</pubKey></h1> <p>hex_script = &quot;76&quot; + &quot;a9&quot; + &quot;14&quot; + pubkey_hash + &quot;88&quot; + &quot;ac&quot;
serialized_script = hex_script.decode(&quot;hex&quot;)</p> <p><a href="https://developer.bitcoin.org/terms.html#term-pp-script" target="_blank" rel="noopener noreferrer">“script”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: (required) You must specify the pubkey script you want the spender to pay—any valid pubkey script is acceptable. In this example, we’ll request payment to a P2PKH pubkey script.</p> <p>“ script” : (必需的)您必须指定您希望花钱的 pubkey 脚本ー任何有效的 pubkey 脚本都是可以接受的。在这个示例中，我们将请求对 P2PKH pubkey 脚本的支付。</p> <p>First we get a pubkey hash. The hash above is the hash form of the address used in the URI examples throughout this section, mjSk1Ny9spzU2fouzYgLqGUD8U41iR35QN.</p> <p>首先我们得到一个 pubkey hash。上面的散列是整个部分的 URI 示例中使用的地址的散列形式，mjSk1Ny9spzU2fouzYgLqGUD8U41iR35QN。</p> <p>Next, we plug that hash into the standard P2PKH pubkey script using hex, as illustrated by the code comments.</p> <p>接下来，我们使用十六进制将该散列插入标准 P2PKH pubkey 脚本，如代码注释所示。</p> <p>Finally, we convert the pubkey script from hex into its serialized form.</p> <p>最后，我们将 pubkey 脚本从十六进制转换为它的序列化形式。</p> <p>details.outputs.add(amount = amount, script = serialized_script)</p> <p><code>outputs</code>: (required) add the pubkey script and (optional) amount to the <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> outputs array.</p> <p>Output: (必需的)将 pubkey 脚本和(可选的) amount 添加到 PaymentDetails 输出数组。</p> <p>It’s possible to specify multiple <a href="https://developer.bitcoin.org/terms.html#term-pp-script" target="_blank" rel="noopener noreferrer">“scripts”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <code>amounts</code> as part of a <a href="https://developer.bitcoin.org/terms.html#term-merge-avoidance" target="_blank" rel="noopener noreferrer">merge avoidance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> strategy, described later in the <a href="https://developer.bitcoin.org/devguide/payment_processing.html#merge-avoidance" target="_blank" rel="noopener noreferrer">Merge Avoidance subsection<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. However, effective <a href="https://developer.bitcoin.org/terms.html#term-merge-avoidance" target="_blank" rel="noopener noreferrer">merge avoidance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is not possible under the base <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" target="_blank" rel="noopener noreferrer">BIP70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>rules in which the spender pays each <a href="https://developer.bitcoin.org/terms.html#term-pp-script" target="_blank" rel="noopener noreferrer">“script”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> the exact amount specified by its paired <a href="https://developer.bitcoin.org/terms.html#term-pp-amount" target="_blank" rel="noopener noreferrer">“amount”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. If the amounts are omitted from all <a href="https://developer.bitcoin.org/terms.html#term-pp-amount" target="_blank" rel="noopener noreferrer">“amount”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>/<a href="https://developer.bitcoin.org/terms.html#term-pp-script" target="_blank" rel="noopener noreferrer">“script”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pairs, the spender will be prompted to choose an amount to pay.</p> <p>可以指定多个“脚本”和金额作为合并回避策略的一部分，在后面的合并回避小节中进行描述。然而，有效的合并规避是不可能的基础 BIP70规则，其中支付支付每个“脚本”的确切金额指定的配对“数额”。如果在所有“金额”/“脚本”对中省略了金额，将提示花钱者选择要支付的金额。</p> <p>details.memo = &quot;Flowers &amp; chocolates&quot;</p> <p><a href="https://developer.bitcoin.org/terms.html#term-pp-memo" target="_blank" rel="noopener noreferrer">“memo”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: (optional) add a memo which will be displayed to the spender as plain UTF-8 text. Embedded HTML or other markup will not be processed.</p> <p>“ memo” : (可选)添加一个备忘录，它将以 UTF-8文本的形式显示给消费者。不会处理嵌入式 HTML 或其他标记。</p> <p>details.merchant_data = &quot;Invoice #123&quot;</p> <p><a href="https://developer.bitcoin.org/terms.html#term-pp-merchant-data" target="_blank" rel="noopener noreferrer">“merchant_data”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: (optional) add arbitrary data which should be sent back to the receiver when the invoice is paid. You can use this to track your invoices, although you can more reliably track payments by generating a <a href="https://developer.bitcoin.org/terms.html#term-unique-address" target="_blank" rel="noopener noreferrer">unique address<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for each payment and then tracking when it gets paid.</p> <p>“ merchant _ data” : (可选)添加任意数据，这些数据应该在发票付款时发送回收件人。你可以使用这个来跟踪你的发票，虽然你可以通过为每个付款生成一个唯一的地址来更可靠地跟踪付款，然后跟踪付款的时间。</p> <p>The <a href="https://developer.bitcoin.org/terms.html#term-pp-memo" target="_blank" rel="noopener noreferrer">“memo”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> field can be arbitrarily long, but if you make them too long, you’ll run into the 50,000 byte limit on the entire <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which includes the often several kilobytes given over to storing the <a href="https://developer.bitcoin.org/terms.html#term-certificate-chain" target="_blank" rel="noopener noreferrer">certificate chain<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. As will be described in a later subsection, the <a href="https://developer.bitcoin.org/terms.html#term-pp-memo" target="_blank" rel="noopener noreferrer">“memo”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> field can be used by the spender after payment as part of a cryptographically-proven <a href="https://developer.bitcoin.org/terms.html#term-receipt" target="_blank" rel="noopener noreferrer">receipt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>“ memo”字段可以任意长，但是如果长度太长，就会在整个 PaymentRequest 中遇到50,000字节的限制，这个限制通常包括用于存储证书链的几千字节。如后面的小节所述，“ memo”字段可以作为经过密码验证的收据的一部分，供支付者在付款后使用。</p> <h4 id="derivable-data-可推导数据"><a href="#derivable-data-可推导数据" class="header-anchor">#</a> Derivable Data 可推导数据<a href="https://developer.bitcoin.org/examples/payment_processing.html#derivable-data" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Next, let’s look at some information your CGI program can automatically derive.</p> <p>接下来，让我们看看您的 CGI 程序可以自动获取的一些信息。</p> <h2 id="request-creation-time"><a href="#request-creation-time" class="header-anchor">#</a> Request creation time</h2> <p>details.time = int(time()) ## Current epoch (Unix) time</p> <h2 id="request-expiration-time"><a href="#request-expiration-time" class="header-anchor">#</a> Request expiration time</h2> <p>details.expires = int(time()) + 60 * 10  ## 10 minutes from now</p> <h2 id="paymentdetails-paymentdetails-is-complete-serialize-it-and-store-it-in-paymentrequest-paymentrequest"><a href="#paymentdetails-paymentdetails-is-complete-serialize-it-and-store-it-in-paymentrequest-paymentrequest" class="header-anchor">#</a> [PaymentDetails][paymentdetails] is complete; serialize it and store it in [PaymentRequest][paymentrequest]</h2> <p>request.serialized_payment_details = details.SerializeToString()</p> <h2 id="serialized-certificate-chain-certificate-chain"><a href="#serialized-certificate-chain-certificate-chain" class="header-anchor">#</a> Serialized [certificate chain][certificate chain]</h2> <p>request.pki_data = x509.SerializeToString()</p> <h2 id="initialize-signature-field-so-we-can-sign-the-full-paymentrequest-paymentrequest"><a href="#initialize-signature-field-so-we-can-sign-the-full-paymentrequest-paymentrequest" class="header-anchor">#</a> Initialize signature field so we can sign the full [PaymentRequest][paymentrequest]</h2> <p>request.signature = &quot;&quot;</p> <h2 id="sign-paymentrequest-paymentrequest"><a href="#sign-paymentrequest-paymentrequest" class="header-anchor">#</a> Sign [PaymentRequest][paymentrequest]</h2> <p>request.signature = sign(private_key, request.SerializeToString(), &quot;sha256&quot;)</p> <p>Each line is described below.</p> <p>每一行都在下面描述。</p> <p>details.time = int(time()) ## Current epoch (Unix) time</p> <p><code>time</code>: (required) <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> must indicate when they were created in number of seconds elapsed since 1970-01-01T00:00 UTC (<a href="https://en.wikipedia.org/wiki/Unix_time" target="_blank" rel="noopener noreferrer">Unix epoch time<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> format).</p> <p>PaymentRequests 必须指出它们是在1970-01-01T00:00 UTC (Unix epoch time format)以秒为单位创建的。</p> <p>details.expires = int(time()) + 60 * 10  ## 10 minutes from now</p> <p><a href="https://developer.bitcoin.org/terms.html#term-pp-expires" target="_blank" rel="noopener noreferrer">“expires”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: (optional) the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> may also set an <a href="https://developer.bitcoin.org/terms.html#term-pp-expires" target="_blank" rel="noopener noreferrer">“expires”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> time after which they’re no longer valid. You probably want to give receivers the ability to configure the expiration time delta; here we used the reasonable choice of 10 minutes. If this request is tied to an order total based on a <a href="https://developer.bitcoin.org/terms.html#term-fiat" target="_blank" rel="noopener noreferrer">fiat<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>-to-satoshis exchange rate, you probably want to base this on a delta from the time you got the exchange rate.</p> <p>“ expires” : (可选) PaymentRequest 还可以设置一个“ expires”时间，在此之后它们将不再有效。您可能希望让接收者能够配置过期时间差; 这里我们使用了10分钟的合理选择。如果此请求与基于菲亚特对萨托希斯汇率的订单总额相关联，那么您可能希望基于从获得汇率时起的增量。</p> <p>request.serialized_payment_details = details.SerializeToString()</p> <p><code>serialized_payment_details</code>: (required) we’ve now set everything we need to create the <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, so we’ll use the SerializeToString function from the <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">protocol buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> code to store the <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in the appropriate field of the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Serialized _ payment _ details: (必需的)我们现在已经设置了创建 PaymentDetails 所需的一切，因此我们将使用 protocol buffer 代码中的 SerializeToString 函数将 PaymentDetails 存储在 PaymentRequest 的适当字段中。</p> <p>request.pki_data = x509.SerializeToString()</p> <p><code>pki_data</code>: (required for signed <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) serialize the <a href="https://developer.bitcoin.org/terms.html#term-certificate-chain" target="_blank" rel="noopener noreferrer">certificate chain<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://developer.bitcoin.org/terms.html#term-pp-pki-data" target="_blank" rel="noopener noreferrer">PKI data<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and store it in the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>PKI _ data: (需要签名的 PaymentRequests)序列化证书链 PKI 数据并将其存储在 PaymentRequest 中</p> <p>request.signature = &quot;&quot;</p> <p>We’ve filled out everything in the <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> except the signature, but before we sign it, we have to initialize the signature field by setting it to a zero-byte placeholder.</p> <p>除了签名之外，我们已经填写了 PaymentRequest 中的所有内容，但在签名之前，我们必须将签名字段设置为零字节占位符，以初始化签名字段。</p> <p>request.signature = sign(private_key, request.SerializeToString(), &quot;sha256&quot;)</p> <p><code>signature</code>: (required for signed <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) now we make the <a href="https://developer.bitcoin.org/terms.html#term-ssl-signature" target="_blank" rel="noopener noreferrer">signature<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> by signing the completed and serialized <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. We’ll use the private key we stored in memory in the configuration section and the same hashing formula we specified in <a href="https://developer.bitcoin.org/terms.html#term-pp-pki-type" target="_blank" rel="noopener noreferrer">“pki_type”<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (sha256 in this case)</p> <p>Signature: (签名的 PaymentRequests 需要)现在我们通过签名已完成的序列化 PaymentRequest 来签名。我们将使用配置节中存储在内存中的私钥和在“ pki _ type”中指定的相同哈希公式(在本例中为 sha256)</p> <h4 id="output-code-输出代码"><a href="#output-code-输出代码" class="header-anchor">#</a> Output Code 输出代码<a href="https://developer.bitcoin.org/examples/payment_processing.html#output-code" title="Permalink to this headline" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Now that we have <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> all filled out, we can serialize it and send it along with the HTTP headers, as shown in the code below.</p> <p>现在我们已经完成了 PaymentRequest，我们可以对它进行序列化，并将其与 HTTP 头一起发送，如下面的代码所示。</p> <p>print &quot;Content-Type: application/bitcoin-[paymentrequest][paymentrequest]&quot;
print &quot;Content-Transfer-Encoding: binary&quot;
print &quot;&quot;</p> <p>(Required) <a href="https://github.com/bitcoin/bips/blob/master/bip-0071.mediawiki" target="_blank" rel="noopener noreferrer">BIP71<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> defines the content types for <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Payments, and PaymentACKs.</p> <p>(必需的) BIP71定义了 PaymentRequests、 PaymentACKs 和 PaymentACKs 的内容类型。</p> <p>file.write(stdout, request.SerializeToString())</p> <p><code>request</code>: (required) now, to finish, we just dump out the serialized <a href="https://developer.bitcoin.org/terms.html#term-paymentrequest" target="_blank" rel="noopener noreferrer">PaymentRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (which contains the serialized <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>). The serialized data is in binary, so we can’t use Python’s print() because it would add an extraneous newline.</p> <p>Request: (必需的)现在，为了完成这个任务，我们只需要转储序列化的 PaymentRequest (它包含序列化的 PaymentDetails)。序列化的数据是二进制的，因此我们不能使用 Python 的 print () ，因为它会添加一个无关的换行符。</p> <p>The following screenshot shows how the authenticated <a href="https://developer.bitcoin.org/terms.html#term-paymentdetails" target="_blank" rel="noopener noreferrer">PaymentDetails<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> created by the program above appears in the GUI from Bitcoin Core 0.9.</p> <p>下面的屏幕截图显示了上面程序创建的经过验证的 PaymentDetails 是如何出现在来自比特币核心0.9的 GUI 中的。</p> <p><img alt="Bitcoin Core Showing Validated Payment Request" data-src="https://developer.bitcoin.org/_images/en-btcc-payment-request.png" loading="lazy" class="lazy"></p> <p>Bitcoin Core Showing Validated Payment Request<a href="https://developer.bitcoin.org/examples/payment_processing.html#id3" title="Permalink to this image" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>比特币核心显示验证支付请求</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#payment-protocol-付款程序" title="Payment Protocol 付款程序[](https://developer.bitcoin.org/examples/payment_processing.html#payment-protocol &quot;Permalink to this headline&quot;)">Payment Protocol 付款程序[](https://developer.bitcoin.org/examples/payment_processing.html#payment-protocol &quot;Permalink to this headline&quot;)</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#paymentrequest-paymentdetails-支付请求和支付详细信息" title="PaymentRequest &amp; PaymentDetails 支付请求和支付详细信息[](https://developer.bitcoin.org/examples/payment_processing.html#paymentrequest-paymentdetails &quot;Permalink to this headline&quot;)">PaymentRequest &amp; PaymentDetails 支付请求和支付详细信息[](https://developer.bitcoin.org/examples/payment_processing.html#paymentrequest-paymentdetails &quot;Permalink to this headline&quot;)</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#this-is-the-code-generated-by-protoc-python-out-paymentrequest-paymentrequest-proto" title="This is the code generated by protoc --python_out=./ [paymentrequest][paymentrequest].proto">This is the code generated by protoc --python_out=./ [paymentrequest][paymentrequest].proto</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#load-some-functions" title="Load some functions">Load some functions</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#copy-three-of-the-classes-created-by-protoc-into-objects-we-can-use" title="Copy three of the classes created by protoc into objects we can use">Copy three of the classes created by protoc into objects we can use</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ssl-signature-method" title="SSL Signature method">SSL Signature method</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#mainnet-or-testnet" title="Mainnet or testnet?">Mainnet or testnet?</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#postback-url" title="Postback URL">Postback URL</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#paymentdetails-paymentdetails-version-number" title="[PaymentDetails][paymentdetails] version number">[PaymentDetails][paymentdetails] version number</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#certificate-chain-certificate-chain" title="[Certificate chain][certificate chain]">[Certificate chain][certificate chain]</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#load-private-ssl-key-into-memory-for-signing-later" title="Load private SSL key into memory for signing later">Load private SSL key into memory for signing later</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#this-is-the-pubkey-certificate-corresponding-to-the-private-ssl-key" title="This is the pubkey/certificate corresponding to the private SSL key">This is the pubkey/certificate corresponding to the private SSL key</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#that-we-ll-use-to-sign" title="that we'll use to sign:">that we'll use to sign:</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#if-the-pubkey-cert-above-didn-t-have-the-signature-of-a-root" title="If the pubkey/cert above didn't have the signature of a root">If the pubkey/cert above didn't have the signature of a root</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#certificate-authority-we-d-then-append-the-intermediate-certificate-intermediate-certificate" title="certificate authority, we'd then append the [intermediate certificate][intermediate certificate]">certificate authority, we'd then append the [intermediate certificate][intermediate certificate]</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#which-signed-it" title="which signed it:">which signed it:</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#amount-of-the-request" title="Amount of the request">Amount of the request</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#p2pkh-pubkey-hash" title="P2PKH pubkey hash">P2PKH pubkey hash</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#p2pkh-pubkey-script-entered-as-hex-and-converted-to-binary" title="P2PKH pubkey script entered as hex and converted to binary">P2PKH pubkey script entered as hex and converted to binary</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#load-amount-and-pubkey-script-into-paymentdetails-paymentdetails" title="Load amount and pubkey script into [PaymentDetails][paymentdetails]">Load amount and pubkey script into [PaymentDetails][paymentdetails]</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#memo-to-display-to-the-spender" title="Memo to display to the spender">Memo to display to the spender</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#data-which-should-be-returned-to-you-with-the-payment" title="Data which should be returned to you with the payment">Data which should be returned to you with the payment</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#request-creation-time" title="Request creation time">Request creation time</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#request-expiration-time" title="Request expiration time">Request expiration time</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#paymentdetails-paymentdetails-is-complete-serialize-it-and-store-it-in-paymentrequest-paymentrequest" title="[PaymentDetails][paymentdetails] is complete; serialize it and store it in [PaymentRequest][paymentrequest]">[PaymentDetails][paymentdetails] is complete; serialize it and store it in [PaymentRequest][paymentrequest]</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#serialized-certificate-chain-certificate-chain" title="Serialized [certificate chain][certificate chain]">Serialized [certificate chain][certificate chain]</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#initialize-signature-field-so-we-can-sign-the-full-paymentrequest-paymentrequest" title="Initialize signature field so we can sign the full [PaymentRequest][paymentrequest]">Initialize signature field so we can sign the full [PaymentRequest][paymentrequest]</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#sign-paymentrequest-paymentrequest" title="Sign [PaymentRequest][paymentrequest]">Sign [PaymentRequest][paymentrequest]</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/baryon" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li><li class="contact-item" data-v-3d9deeb8><a href="mailto:lilong@gmail.com" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-3d9deeb8><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-3d9deeb8></path><polyline points="22,6 12,13 2,6" data-v-3d9deeb8></polyline></svg>
          
        </a></li><li class="contact-item" data-v-3d9deeb8><a href="https://twitter.com/lilong" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter" data-v-3d9deeb8><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" data-v-3d9deeb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8><a href="/about/" class="nav-link" data-v-3d9deeb8>LI Long © 2020</a></li><li class="copyright-item" data-v-3d9deeb8><a href="/" class="nav-link" data-v-3d9deeb8>Made with ❤</a></li><li class="copyright-item" data-v-3d9deeb8><a href="https://creativecommons.org/licenses/by-nc-sa/2.5/cn/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8>CC BY-NC-SA 2.5</a></li></ul></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.abf5d3ec.js" defer></script><script src="/assets/js/8.ce1c8cc9.js" defer></script><script src="/assets/js/3.414e57ad.js" defer></script><script src="/assets/js/37.0fd00712.js" defer></script>
  </body>
</html>
