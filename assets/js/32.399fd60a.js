(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{569:function(_,t,v){"use strict";v.r(t);var d=v(8),r=Object(d.a)({},(function(){var _=this,t=_.$createElement,v=_._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("p",[_._v("昨天夜间，BSV bot的作者("),v("a",{attrs:{href:"https://aaron67.cc/2020/11/08/lost-600-bsv/",target:"_blank",rel:"noopener noreferrer"}},[_._v("我被盗了 600 BSV | aaron67's log"),v("OutboundLink")],1),_._v("遭遇了可怕的大量币丢失事件。")]),_._v(" "),v("p",[_._v("这是黑客盗取的交易\nhttps://whatsonchain.com/tx/20adad8bd4cc694cfed4ccadff911433601e55b0f8779e839bc6579cb8d234f9")]),_._v(" "),v("p",[_._v("盗取时间是"),v("code",[_._v("时间戳 2020-11-06 15:44:45 utc")]),_._v("。而币是在"),v("code",[_._v("时间戳 2020-11-06 14:33:45 utc")]),_._v("， 也就是1个小时之前转入这个多签地址的。\n黑客用的解锁脚本居然是"),v("code",[_._v("00 00")]),_._v(".")]),_._v(" "),v("p",[_._v("解锁和锁定脚本连起来后，分析结果为")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[v("strong",[_._v("行号")])]),_._v(" "),v("th",[v("strong",[_._v("脚本")])]),_._v(" "),v("th",[v("strong",[_._v("主栈（左侧是栈底，右侧是栈顶）")])]),_._v(" "),v("th",[v("strong",[_._v("从栈（左侧是栈底，右侧是栈顶）")])]),_._v(" "),v("th",[v("strong",[_._v("说明")])])])]),_._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[_._v("1")])]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("未设置第1个签名和公钥")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("2")])]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("0 0")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("未设置第2个签名和公钥")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("3")])]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("0 0 0")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("匹配成功的公钥数量，初始值0")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("4")])]),_._v(" "),v("td",[_._v("OP_TOALTSTACK")]),_._v(" "),v("td",[_._v("0 0")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("将初始值0放入从栈")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("5")])]),_._v(" "),v("td",[_._v("OP_IF")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("第2个公钥为假，跳过行6到行14")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("6")])]),_._v(" "),v("td",[_._v("OP_DUP")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("7")])]),_._v(" "),v("td",[_._v("OP_HASH160")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("8")])]),_._v(" "),v("td",[_._v("dd2d89bb9f64cbdf4139ff0e23c4813124af85e6")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("9")])]),_._v(" "),v("td",[_._v("OP_EQUALVERIFY")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("10")])]),_._v(" "),v("td",[_._v("OP_CHECKSIGVERIFY")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("11")])]),_._v(" "),v("td",[_._v("OP_FROMALTSTACK")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("12")])]),_._v(" "),v("td",[_._v("OP_1ADD")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("13")])]),_._v(" "),v("td",[_._v("OP_TOALTSTACK")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("14")])]),_._v(" "),v("td",[_._v("OP_ENDIF")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("15")])]),_._v(" "),v("td",[_._v("OP_IF")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("第1个公钥为假，跳过行16到行24")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("16")])]),_._v(" "),v("td",[_._v("OP_DUP")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("17")])]),_._v(" "),v("td",[_._v("OP_HASH160")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("18")])]),_._v(" "),v("td",[_._v("aef82c0ef3f0c1d867e12b64e9e8d2ebb983dc81")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("19")])]),_._v(" "),v("td",[_._v("OP_EQUALVERIFY")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("20")])]),_._v(" "),v("td",[_._v("OP_CHECKSIGVERIFY")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("21")])]),_._v(" "),v("td",[_._v("OP_FROMALTSTACK")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("22")])]),_._v(" "),v("td",[_._v("OP_1ADD")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("23")])]),_._v(" "),v("td",[_._v("OP_TOALTSTACK")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("24")])]),_._v(" "),v("td",[_._v("OP_ENDIF")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("25")])]),_._v(" "),v("td",[_._v("OP_2")]),_._v(" "),v("td",[_._v("2")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("最少需要的公钥数量")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("26")])]),_._v(" "),v("td",[_._v("OP_FROMALTSTACK")]),_._v(" "),v("td",[_._v("2 0")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("从栈数据移入主栈")])]),_._v(" "),v("tr",[v("td",[v("strong",[_._v("27")])]),_._v(" "),v("td",[_._v("OP_GREATERTHANOREQUAL")]),_._v(" "),v("td",[_._v("TRUE")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("最少需要的数量是否小于解锁的公钥数量（这里有错误？应该为 OP_LESSTHANOREQUAL ）")])])])]),_._v(" "),v("p",[_._v("最后的一行出BUG了。脚本完整的分析见"),v("a",{attrs:{href:"https://aaron67-public.oss-cn-beijing.aliyuncs.com/notesv-bug-analysis-multisig-accumulator.pdf",target:"_blank",rel:"noopener noreferrer"}},[_._v("PDF"),v("OutboundLink")],1)]),_._v(" "),v("p",[_._v("经推测经纬是，andy写了个多签原型，里面有个条件比较的bug。然后esv没有仔细测试，就作为产品发布了。aaron喜欢新鲜事物，小笔尝试了一下，没问题。大笔存入，一个小时后，黑客出现，挥挥手拿走，不留一分[捂脸]")])])}),[],!1,null,null,null);t.default=r.exports}}]);